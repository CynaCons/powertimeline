:root {
  /* === Page-level Theme Variables === */
  /* These are used by pages (HomePage, LandingPage, etc.) */
  --page-bg: #0d1117;
  --page-bg-elevated: #161b22;
  --page-border: #30363d;
  --page-text-primary: #e6edf3;
  --page-text-secondary: #9ba3af; /* Improved from #8d96a0 for WCAG AA contrast */
  --page-accent: #8b5cf6;
  --page-accent-hover: #7c3aed;
  --nav-bg: #161b22;
  --nav-border: #30363d;
  --card-bg: #161b22;
  --card-border: #30363d;
  --card-border-hover: #8b5cf6;
  --input-bg: #161b22;
  --input-border: #30363d;
  --input-focus-border: #8b5cf6;
  --input-focus-shadow: rgba(139, 92, 246, 0.1);

  /* Typography Scale */
  --text-xs: 0.75rem;
  --text-xs-lh: 1rem;
  --text-sm: 0.875rem;
  --text-sm-lh: 1.25rem;
  --text-base: 1rem;
  --text-base-lh: 1.5rem;
  --text-lg: 1.125rem;
  --text-lg-lh: 1.75rem;
  --text-xl: 1.25rem;
  --text-xl-lh: 1.75rem;
  --text-2xl: 1.5rem;
  --text-2xl-lh: 2rem;
  --text-3xl: 1.875rem;
  --text-3xl-lh: 2.25rem;

  /* Font Weights */
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  /* Spacing Scale */
  --space-1: 0.25rem; /* 4px */
  --space-2: 0.5rem; /* 8px */
  --space-3: 0.75rem; /* 12px */
  --space-4: 1rem; /* 16px */
  --space-6: 1.5rem; /* 24px */
  --space-8: 2rem; /* 32px */
  --space-12: 3rem; /* 48px */
  --space-16: 4rem; /* 64px */
  --space-20: 5rem; /* 80px */

  /* Shadows - Elevation Scale */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1), 0 10px 10px rgba(0, 0, 0, 0.04);
  --shadow-card-hover: 0 10px 30px -10px rgba(0, 0, 0, 0.15);
  --shadow-accent-glow: 0 4px 12px rgba(139, 92, 246, 0.3);

  /* Transitions */
  --duration-fast: 150ms;
  --duration-normal: 200ms;
  --duration-slow: 300ms;
  --easing-ease-out: cubic-bezier(0, 0, 0.2, 1);
  --easing-ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);

  /* Brand */
  --color-beta-orange: #f97316;
  --gradient-brand: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);

  /* Navigation */
  --nav-hover-bg: color-mix(in srgb, var(--page-accent) 16%, var(--nav-bg, transparent));
  --nav-active-bg: color-mix(in srgb, var(--page-accent) 22%, var(--nav-bg, transparent));

  /* === Editor/Canvas Theme Variables (Dark) === */
  /* Palette */
  --cc-bg-steel-0: #0f1418;
  --cc-bg-steel-1: #131a20;
  --cc-bg-steel-2: #161f26;
  --cc-bg-steel-3: #1a232b;
  --cc-bg-app: #131a20;
  --cc-color-axis-label: #e6edf3; /* Light text for dark theme */
  --cc-color-axis-line: #ffffff60;
  --cc-color-axis-line-strong: #ffffff80;
  --cc-color-grid-minor: #ffffff25;
  --cc-color-grid-major: #ffffff40;
  --cc-color-focus-accent: #74c7ec;
  --cc-color-border: #2a3642;
  --cc-color-panel-bg: #1f2932;
  --cc-color-panel-fg: #e2e8f0;
  --cc-color-accent-primary: #5090ea;
  --cc-color-accent-primary-hover: #367bd9;
  --cc-color-anchor-fill: #e5e7eb; /* small light grey square */
  --cc-color-anchor-hover: #d1d5db; /* slightly darker on hover */
  --cc-color-anchor-outline: #9ca3af; /* subtle outline */
  --cc-color-anchor-selected: #4f9dfc; /* refined selection tone */
  --cc-color-selection-glow: #63b3ff55; /* translucent glow */
  --cc-color-connector: #94a3b8;
  --cc-color-card-bg: #1d2730;
  --cc-color-card-border: #2e3a46;
  --cc-color-card-divider: #2b3742;
  --cc-color-card-title: #f1f5f9;
  --cc-color-card-body: #c5d0d9;

  /* Typography */
  --cc-font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --cc-font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";

  /* Sizing & spacing */
  --cc-space-0: 0;
  --cc-space-1: 2px;
  --cc-space-2: 4px;
  --cc-space-3: 6px;
  --cc-space-4: 8px;
  --cc-space-5: 10px;
  --cc-space-6: 12px;
  --cc-gutter-x: 16px; /* horizontal spacing between columns */
  --cc-gutter-y: 10px; /* vertical spacing between rows */
  --cc-axis-clearance: 14px; /* min distance from axis line to nearest card edge */
  --cc-connector-width: 1.5px; /* connector stroke width */
  --cc-card-w-full: 256px;
  --cc-card-h-full: 96px;
  --cc-card-w-compact: 176px;
  --cc-card-h-compact: 64px;
  --cc-card-w-minimal: 140px;
  --cc-card-h-minimal: 32px;
  --cc-radius-sm: 3px;
  --cc-radius-md: 6px;
  --cc-radius-card: 4px; /* new card radius */
  --cc-card-pad: 0.6; /* viewBox units padding reference */

  /* Effects */
  --cc-focus-ring-width: 0.6;
  --cc-shadow-card: 0 2px 4px -2px #00000080, 0 4px 16px -4px #00000066;

  /* Z-index conventions */
  --cc-z-hud: 1000;
  --cc-z-anchors: 500;
  --cc-z-cards: 200;
  --cc-z-grid: 150;
  --cc-z-background: 0;

  /* ================================================
     Z-Index Layer System
     ================================================
     Consistent layering for UI components across the app.
     Use these variables instead of arbitrary z-index values.

     Layers (lowest to highest):
     - Canvas layers (0-20): Timeline content rendering
       --z-canvas (0): Base timeline SVG content
       --z-cards (10): Event cards on canvas
       --z-anchors (20): Timeline anchors and connectors

     - Fixed UI layers (50-100): Persistent UI components
       --z-minimap (50): Minimap component (bottom-right)
       --z-navigation (60): NavigationRail, breadcrumbs, TopNavBar
       --z-panels (100): Side panels (EventsPanel, ChatPanel)

     - Overlay layers (500+): Temporary UI overlays
       --z-overlays (500): Full-screen overlays (StreamView, AuthoringOverlay)
       --z-modals (1000): Modal dialogs and backdrops
       --z-toasts (1400): Toast notifications
       --z-stream-panel (1500): Stream edit panel (must be above toasts)

     Usage example:
       .my-component { z-index: var(--z-navigation); }
     ================================================ */

  /* Canvas layers */
  --z-canvas: 0;
  --z-cards: 10;
  --z-anchors: 20;

  /* Fixed UI layers */
  --z-minimap: 50;
  --z-navigation: 60;
  --z-panels: 100;

  /* Overlay layers */
  --z-overlays: 500;
  --z-modals: 1000;
  --z-toasts: 1400;
  --z-stream-panel: 1500;

  /* Axis sizing */
  --cc-axis-line-width: 0.18;

  /* Background gradient (subtle vignette) */
  --cc-bg-gradient: radial-gradient(120% 140% at 50% -10%, var(--cc-bg-steel-2) 0%, var(--cc-bg-steel-1) 55%, var(--cc-bg-steel-0) 85%);

  /* New Accent & Semantic Tokens (Phase E) */
  --cc-color-accent-create: #06b6d4; /* replaces prior #0ff cyan */
  --cc-color-accent-create-fade: #06b6d4b3;
  --cc-color-success-bg: #059669;
  --cc-color-success-fg: #ffffff;
  --cc-color-danger-bg: #334350;
  --cc-color-danger-fg: #e2e8f0;
  --cc-color-input-bg: #1e2a33;
  --cc-color-input-border: #334350;
  --cc-color-input-placeholder: #64748b;
  --cc-color-focus-ring: var(--cc-color-focus-accent);
  --cc-focus-ring-outline: 2px solid var(--cc-color-focus-ring);

  /* Scrollbar styling (dark theme) */
  --scrollbar-track: #0d1117;
  --scrollbar-thumb: #4a5568;
  --scrollbar-thumb-hover: #718096;

  /* Animation durations */
  --animation-stagger-delay: 50ms;

  /* Stream Viewer (v0.5.26) */
  --stream-rail-color: #30363d;
  --stream-dot-size: 14px;
  --stream-dot-color: #8b5cf6;
  --stream-dot-color-hover: #a78bfa;
  --stream-date-width: 56px;
  --stream-card-gap: 20px;
  --stream-bg: #0d1117;
  --stream-card-bg: #161b22;
  --stream-card-border: #30363d;
  --stream-text-primary: #e6edf3;
  --stream-text-secondary: #9ba3af; /* Improved from #8d96a0 for WCAG AA contrast */
  --stream-text-muted: #8d96a0; /* Improved from #6e7681 for WCAG AA contrast */

  /* Preview Event Styling (AI-created temporary events) */
  --preview-bg: rgba(245, 158, 11, 0.15); /* amber with transparency for dark mode */
  --preview-border: #f59e0b; /* amber-500 */
  --preview-glow: rgba(245, 158, 11, 0.3);

  /* Semantic colors */
  --color-danger: #dc2626;
  --color-danger-hover: #b91c1c;
  --color-success: #1f883d;
  --color-success-hover: #1a7f37;
  --color-error-500: #ef4444;
  --color-error-200: rgba(239, 68, 68, 0.3);
  --color-error-50: rgba(239, 68, 68, 0.08);
  --color-warning-500: #f59e0b;
}

/* === Light Theme Overrides === */
[data-theme="light"] {
  /* Page-level variables */
  --page-bg: #ffffff;
  --page-bg-elevated: #f6f8fa;
  --page-border: #d0d7de;
  --page-text-primary: #1f2328;
  --page-text-secondary: #57606a; /* Improved from #656d76 for WCAG AA contrast */
  --page-accent: #8b5cf6;
  --page-accent-hover: #7c3aed;
  --nav-bg: #f6f8fa;
  --nav-border: #d0d7de;
  --card-bg: #ffffff;
  --card-border: #d0d7de;
  --card-border-hover: #8b5cf6;
  --input-bg: #ffffff;
  --input-border: #d0d7de;
  --input-focus-border: #8b5cf6;
  --input-focus-shadow: rgba(139, 92, 246, 0.15);

  /* Editor/Canvas variables for light mode */
  --cc-bg-steel-0: #f0f2f5;
  --cc-bg-steel-1: #f6f8fa;
  --cc-bg-steel-2: #ffffff;
  --cc-bg-steel-3: #ffffff;
  --cc-bg-app: #f6f8fa;
  --cc-color-axis-label: #1f2328;
  --cc-color-axis-line: #00000040;
  --cc-color-axis-line-strong: #00000060;
  --cc-color-grid-minor: #00000015;
  --cc-color-grid-major: #00000025;
  --cc-color-border: #d0d7de;
  --cc-color-panel-bg: #ffffff;
  --cc-color-panel-fg: #1f2328;
  --cc-color-card-bg: #ffffff;
  --cc-color-card-border: #d0d7de;
  --cc-color-card-divider: #d0d7de;
  --cc-color-card-title: #1f2328;
  --cc-color-card-body: #656d76;
  --cc-bg-gradient: linear-gradient(180deg, #f6f8fa 0%, #ffffff 100%);

  /* Scrollbar styling (light theme) */
  --scrollbar-track: #f0f0f0;
  --scrollbar-thumb: #888888;
  --scrollbar-thumb-hover: #666666;

  /* Stream Viewer (light theme) */
  --stream-rail-color: #d0d7de;
  --stream-dot-color: #8b5cf6;
  --stream-dot-color-hover: #7c3aed;
  --stream-bg: #ffffff;
  --stream-card-bg: #f6f8fa;
  --stream-card-border: #d0d7de;
  --stream-text-primary: #1f2328;
  --stream-text-secondary: #57606a; /* Improved from #656d76 for WCAG AA contrast */
  --stream-text-muted: #656d76; /* Improved from #8c959f for WCAG AA contrast */

  /* Preview Event Styling (light mode) */
  --preview-bg: rgba(251, 191, 36, 0.2); /* amber-400 with transparency for light mode */
  --preview-border: #f59e0b; /* amber-500 */
  --preview-glow: rgba(245, 158, 11, 0.4);
}

/* === Timeline Card Component Styles === */
/* Premium card styling with depth and hover lift */
.timeline-card {
  border: 1px solid var(--card-border);
  box-shadow: var(--shadow-sm);
  border-radius: 12px;
  transition: all var(--duration-normal) var(--easing-ease-out);
  background: var(--card-bg);
}

.timeline-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-card-hover);
  border-color: var(--card-border-hover);
}

.timeline-card:focus-visible {
  outline: 2px solid var(--page-accent);
  outline-offset: 2px;
}

/* Dark mode adjustments for enhanced shadow visibility */
[data-theme="dark"] .timeline-card {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .timeline-card:hover {
  box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.4);
}

/* High contrast mode adjustments (Phase F) */
@media (forced-colors: active) {
  :root {
    --cc-color-focus-ring: Highlight;
    --cc-color-anchor-fill: ButtonFace;
    --cc-color-anchor-outline: ButtonText;
    --cc-color-card-bg: Canvas;
    --cc-color-card-border: ButtonText;
    --cc-color-card-title: ButtonText;
    --cc-color-card-body: ButtonText;
    --cc-color-connector: ButtonText;
  }
  svg g[role="button"] rect { forced-color-adjust: auto; }
}

/* === Scrollbar Styling === */
/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}

/* Webkit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
}

::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--scrollbar-thumb-hover);
}

::-webkit-scrollbar-corner {
  background: var(--scrollbar-track);
}

/* === Card Grid Animations === */
/* Stagger animation for card grids */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.card-animate {
  animation: fadeInUp 0.3s ease-out forwards;
  opacity: 0;
}

/* Stagger delays for up to 20 cards (4 rows of 5) */
.card-animate:nth-child(1) { animation-delay: 0ms; }
.card-animate:nth-child(2) { animation-delay: 50ms; }
.card-animate:nth-child(3) { animation-delay: 100ms; }
.card-animate:nth-child(4) { animation-delay: 150ms; }
.card-animate:nth-child(5) { animation-delay: 200ms; }
.card-animate:nth-child(6) { animation-delay: 250ms; }
.card-animate:nth-child(7) { animation-delay: 300ms; }
.card-animate:nth-child(8) { animation-delay: 350ms; }
.card-animate:nth-child(9) { animation-delay: 400ms; }
.card-animate:nth-child(10) { animation-delay: 450ms; }
.card-animate:nth-child(11) { animation-delay: 500ms; }
.card-animate:nth-child(12) { animation-delay: 550ms; }
.card-animate:nth-child(13) { animation-delay: 600ms; }
.card-animate:nth-child(14) { animation-delay: 650ms; }
.card-animate:nth-child(15) { animation-delay: 700ms; }
.card-animate:nth-child(16) { animation-delay: 750ms; }
.card-animate:nth-child(17) { animation-delay: 800ms; }
.card-animate:nth-child(18) { animation-delay: 850ms; }
.card-animate:nth-child(19) { animation-delay: 900ms; }
.card-animate:nth-child(20) { animation-delay: 950ms; }

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .card-animate {
    animation: none;
    opacity: 1;
  }
}
